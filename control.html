<html>
	<head>
		<style>			
html, body
{
    height: 100%;
    width: 100%;
    margin: 0px;
    overflow: hidden;
}
canvas
{
    width: 100%;
    height: 100%;
}			
		</style>
	</head>
	<body style="margin:0px;">
		<canvas></canvas>
		<script src="/socket.io/socket.io.js"></script>

		<script>

let socket = io();
console.log(socket);

let key = parseInt((new URLSearchParams(window.location.search)).get('key'));
socket.emit('newplayer', key);
			
window.addEventListener('deviceorientation', (event)=>{
	document.getElementById('output').innerHTML = event.alpha + "<br />" + event.beta + "<br />" + event.gamma;
	socket.emit('move', {x:event.alpha, y:event.beta, z:event.gamma, key:key});
	return false;
});
			
let c = document.getElementById("canvas");
    let canvasElementStyle = window.getComputedStyle(c);
    c.width = parseInt(canvasElementStyle.width);
c.height = parseInt(canvasElementStyle.height);

let chargeTimer = 0;
let chargeTime = 150;
let startCharge = false;
			
ontouchstart = (event)=>{
	startCharge = true;
}

ontouchend = (event)=>{
	startCharge = false;
	chargeTimer = 0;
}

let loop = setInterval(render, 1000/60);
			
function render(ctx){
	if(startCharge){
		f.fillStyle = `hsl(60*key, 70%, ${80*chargeTimer/chargeTime}%)`;
		if(chargeTimer < chargeTime){
			chargeTimer++;
		}	
	} else {
		f.fillStyle = "black";
	}
}			
		</script>

	</body>
</html>
